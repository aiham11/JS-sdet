
private String stripFormatting(String input) {
    if (input == null) {
        return ""; // Return an empty string if input is null
    }
    // Preserve existing new lines, remove HTML tags, and trim
    return input.replaceAll("<[^>]*>", "") // Remove HTML tags
                .replaceAll(" +", " ")    // Replace multiple spaces with a single space
                .replaceAll("\\s{2,}", "\n") // Replace sequences of whitespace (2+ spaces) with a new line
                .trim();                   // Trim leading and trailing whitespace
}

 
