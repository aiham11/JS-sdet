import com.rallydev.rest.request.UpdateRequest;
import com.rallydev.rest.response.UpdateResponse;

private void moveAttachmentsToTestStep(String rallyTestStepOID, List<String> attachmentOIDs, RallyRestApi rallyRestApi) {
    for (String attachmentOID : attachmentOIDs) {
        try {
            JsonObject updateAttachment = new JsonObject();
            updateAttachment.addProperty("Artifact", rallyTestStepOID);

            // UpdateRequest constructor takes the ref (including the OID) and the JSON object with updated data
            UpdateRequest updateRequest = new UpdateRequest("/attachment/" + attachmentOID, updateAttachment);
            UpdateResponse updateResponse = rallyRestApi.update(updateRequest);

            if (updateResponse.wasSuccessful()) {
                logger.info("Successfully moved attachment OID " + attachmentOID + " to test step " + rallyTestStepOID);
            } else {
                logger.error("Failed to move attachment OID " + attachmentOID + " to test step " + rallyTestStepOID + ". Error: " + updateResponse.getErrors());
            }
        } catch (Exception e) {
            logger.error("Exception while moving attachment OID " + attachmentOID + " to test step " + rallyTestStepOID, e);
        }
    }
}
