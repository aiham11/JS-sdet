private void moveAttachmentsToTestStep(String rallyTestStepOID, List<String> attachmentOIDs, RallyRestApi rallyRestApi) {
    for (String attachmentOID : attachmentOIDs) {
        try {
            // Fetch the existing attachment details
            GetRequest getRequest = new GetRequest("/attachment/" + attachmentOID);
            GetResponse getResponse = rallyRestApi.get(getRequest);
            
            if (getResponse.wasSuccessful()) {
                JsonObject attachmentDetails = getResponse.getObject();
                
                // Update the Artifact field to point to the new Test Step
                attachmentDetails.addProperty("Artifact", rallyTestStepOID);
                
                // Create an UpdateRequest with the updated details
                UpdateRequest updateRequest = new UpdateRequest("/attachment/" + attachmentOID, attachmentDetails);
                UpdateResponse updateResponse = rallyRestApi.update(updateRequest);

                if (updateResponse.wasSuccessful()) {
                    logger.info("Successfully moved attachment OID " + attachmentOID + " to test step " + rallyTestStepOID);
                } else {
                    logger.error("Failed to move attachment OID " + attachmentOID + " to test step " + rallyTestStepOID + ". Error: " + Arrays.toString(updateResponse.getErrors()));
                }
            } else {
                logger.error("Failed to retrieve attachment OID " + attachmentOID + " for updating. Error: " + Arrays.toString(getResponse.getErrors()));
            }
        } catch (Exception e) {
            logger.error("Exception while moving attachment OID " + attachmentOID + " to test step " + rallyTestStepOID, e);
        }
    }
}
