public String createRallyTestStep(String rallyTestcaseOID, JSONObject testStepJson) {
    RallyRestApi restApi = null;
    String rallyTestStepOID = null;
    try {
        restApi = new RallyRestApi(new URI(rallyBaseURL), rallyApiKey);
        restApi.setApplicationName("CreateTestCaseApp");

        JsonObject newTestStep = new JsonObject();
        newTestStep.addProperty("TestCase", rallyTestcaseOID);
        newTestStep.addProperty("StepIndex", testStepJson.getInt("index"));

        // Check if keys exist before accessing them
        if (testStepJson.has("description")) {
            newTestStep.addProperty("Input", testStepJson.getString("description"));
        } else {
            newTestStep.addProperty("Input", "No description provided");
        }

        if (testStepJson.has("expectedResult")) {
            newTestStep.addProperty("ExpectedResult", testStepJson.getString("expectedResult"));
        } else {
            newTestStep.addProperty("ExpectedResult", "No expected result provided");
        }

        if (testStepJson.has("testData")) {
            newTestStep.addProperty("ValidationInput", testStepJson.getString("testData"));
        } else {
            newTestStep.addProperty("ValidationInput", "No test data provided");
        }

        CreateRequest createTestStepRequest = new CreateRequest("TestStep", newTestStep);
        CreateResponse createTestStepResponse = restApi.create(createTestStepRequest);

        if (createTestStepResponse.wasSuccessful()) {
            rallyTestStepOID = createTestStepResponse.getObject().get("_ref").getAsString();
            logger.info("Successfully created test step in Rally with OID: " + rallyTestStepOID);
        } else {
            logger.error("Error occurred creating test step in Rally.");
            for (String error : createTestStepResponse.getErrors()) {
                logger.error(error);
            }
        }

    } catch (Exception e) {
        logger.error("Exception occurred while creating test step in Rally: ", e);
    } finally {
        if (restApi != null) {
            try {
                restApi.close();
            } catch (Exception e) {
                logger.error("Exception occurred while closing Rally REST API: ", e);
            }
        }
    }
    return rallyTestStepOID;
}
