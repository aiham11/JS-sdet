private String getTestStepRef(RallyRestApi rallyApi, String rallyTestCaseOID, int stepIndex) throws IOException {
    // Create a query request for the "testcasestep" endpoint
    QueryRequest request = new QueryRequest("testcasestep");
    request.setQueryFilter(new QueryFilter("TestCase.ObjectID", "=", rallyTestCaseOID)
            .and(new QueryFilter("StepIndex", "=", String.valueOf(stepIndex))));
    request.setFetch(new Fetch("ObjectID"));

    // Execute the query and get the results
    QueryResponse response = rallyApi.query(request);
    
    if (response.wasSuccessful() && response.getTotalResultCount() > 0) {
        JsonObject queryResult = response.getResults().get(0).getAsJsonObject();
        return queryResult.get("_ref").getAsString();
    } else {
        logger.error("Test step not found for TestCase OID: " + rallyTestCaseOID + " and StepIndex: " + stepIndex);
        throw new IOException("Test step not found");
    }
}
